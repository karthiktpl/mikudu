<!DOCTYPE html>
<html lang="en" >

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Mikudu</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/main.css" rel="stylesheet">
    <link href="css/toaster.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<script type="text/javascript" src="cordova.js"></script>
    
</head>

<body >
	<header  class="header" >
		<section  class="main2">
			<div class="navbar navbar-default " role="navigation">
				<div class="container"> 
					<div class="navbar-header">
						<!--<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span> 
						</button>-->
						<a href="index.html#/dashboard"  class="navbar-brand" id="buttonclose"><img src="img/logomain.png" style="margin-bottom: 50px;"></a>
					</div>						
				</div>
			</div>
			<div class="container" ng-controller="mapCtrl">
				<div class="row">
					<div class="col-lg-12 text-left">
						<div class="panel panel-primary" >
							<div class="panel-heading"><img src="img/hed.png" class="bldbnk">Blood Request</div>
							<div class="panel-body">

								<div style="width:100%;height:400px" id="map_canvas"> </div>
								<button id="button">Full Screen</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>	
    </header>  			

			
</body>
  <toaster-container toaster-options="{'time-out': 3000}"></toaster-container>
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
	<script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
	<script src="js/bootstrap.min.js"></script>


<script type="text/javascript">
$(function(){

$('.indexlink').click(function(){
	div = document.getElementById("map_canvas");
    var tmpmap = plugin.google.maps.Map.getMap(div);
    tmpmap.remove();
	window.location = 'index.html';
	return false;
})
});
var map;
document.addEventListener("deviceready", function() {
	var div = document.getElementById("map_canvas");

  // Initialize the map view
	map = plugin.google.maps.Map.getMap(div);

  // Wait until the map is ready status.
	map.addEventListener(plugin.google.maps.event.MAP_READY, onMapReady);
	var storage = window.localStorage; 
	var district=storage.getItem('blooddistrict');
	var value = Setmarkers(district);	
	onBtnClicked(value)
  
}, false);

function onMapReady() {
  var button = document.getElementById("button");
  var buttonclose = document.getElementById("buttonclose");
  button.addEventListener("click", onBtnClicked);
  buttonclose.addEventListener("click", onBtnClose);
}
function onBtnClose()
{
	map.remove();
	return true;
}

function onBtnClicked(value) {

  // Move to the position with animation
  const district = new plugin.google.maps.LatLng(value.districtlat);
  map.animateCamera({
    target: district,
    zoom: 17,
    tilt: 60,
    bearing: 140,
    duration: 5000
  }, function() {

    // Add a maker
    map.addMarker({
      position: district,
      title: "Welecome to \n" +
             "Cordova GoogleMaps plugin for iOS and Android",
      snippet: "This plugin is awesome!",
      animation: plugin.google.maps.Animation.BOUNCE
    }, function(marker) {

      // Show the info window
      marker.showInfoWindow();

      // Catch the click event
      marker.on(plugin.google.maps.event.INFO_CLICK, function() {

        // To do something...
        alert("Hello world!");

      });
    });
  });
}
function Setmarkers(district)
{
		var markers;
		$.ajax({
		  type: "GET",
		  async: false,
		  global: false,
		  dataType: "json",
		  url: "http://hg.solminds.com/mikuduapi/v1/bloodbanks?district="+district,
		  success: function (result){
			markers=result;
		  }
		});
		return markers;
}
</script>  
</html>
